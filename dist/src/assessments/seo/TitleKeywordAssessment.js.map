{"version":3,"sources":["../../../../src/assessments/seo/TitleKeywordAssessment.js"],"names":["escape","merge","Assessment","createAnchorOpeningTag","AssessmentResult","TitleKeywordAssessment","constructor","config","defaultConfig","parameters","recommendedPosition","scores","good","okay","bad","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","_keywordMatches","getResearch","_keyword","getKeyword","assessmentResult","calculatedResult","calculateResult","setScore","score","setText","resultText","isApplicable","hasKeyword","hasTitle","keyword","exactMatchFound","position","allWordsFound","exactMatchKeyphrase","sprintf","dgettext"],"mappings":"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","file":"TitleKeywordAssessment.js","sourcesContent":["import { escape, merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment to check whether the keyword is included in (the beginning of) the SEO title.\n */\nclass TitleKeywordAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t * @param {number} [config.parameters.recommendedPosition] The recommended position of the keyword within the title.\n\t * @param {number} [config.scores.good] The score to return if the keyword is found at the recommended position.\n\t * @param {number} [config.scores.okay] The score to return if the keyword is found, but not at the recommended position.\n\t * @param {number} [config.scores.bad] The score to return if there are fewer keyword occurrences than the recommended minimum.\n\t * @param {string} [config.url] The URL to the relevant article on Yoast.com.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tparameters: {\n\t\t\t\trecommendedPosition: 0,\n\t\t\t},\n\t\t\tscores: {\n\t\t\t\tgood: 9,\n\t\t\t\tokay: 6,\n\t\t\t\tbad: 2,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/33g\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/33h\" ),\n\t\t};\n\n\t\tthis.identifier = \"titleKeyword\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Executes the pagetitle keyword assessment and returns an assessment result.\n\t *\n\t * @param {Paper} paper The Paper object to assess.\n\t * @param {Researcher} researcher The Researcher object containing all available researches.\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {AssessmentResult} The result of the assessment with text and score.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis._keywordMatches = researcher.getResearch( \"findKeywordInPageTitle\" );\n\t\tthis._keyword = escape( paper.getKeyword() );\n\n\t\tconst assessmentResult = new AssessmentResult();\n\n\t\tconst calculatedResult = this.calculateResult( i18n, this._keyword );\n\t\tassessmentResult.setScore( calculatedResult.score );\n\t\tassessmentResult.setText( calculatedResult.resultText );\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Checks whether the assessment is applicable to the paper\n\t *\n\t * @param {Paper} paper The Paper object to assess.\n\t *\n\t * @returns {boolean} Whether the paper has a keyword and a title.\n\t */\n\tisApplicable( paper ) {\n\t\treturn paper.hasKeyword() && paper.hasTitle();\n\t}\n\n\t/**\n\t * Calculates the result based on whether and how the keyphrase was matched in the title. Returns GOOD result if\n\t * an exact match of the keyword is found in the beginning of the title. Returns OK results if all content words\n\t * from the keyphrase are in the title (in any form). Returns BAD otherwise.\n\t *\n\t * @param {Jed} i18n The object used for translations.\n\t * @param {string} keyword The keyword of the paper (to be returned in the feedback strings).\n\t *\n\t * @returns {Object} Object with score and text.\n\t */\n\tcalculateResult( i18n, keyword ) {\n\t\tconst exactMatchFound = this._keywordMatches.exactMatchFound;\n\t\tconst position = this._keywordMatches.position;\n\t\tconst allWordsFound = this._keywordMatches.allWordsFound;\n\t\tconst exactMatchKeyphrase = this._keywordMatches.exactMatchKeyphrase;\n\n\t\tif ( exactMatchFound === true ) {\n\t\t\tif ( position === 0 ) {\n\t\t\t\treturn {\n\t\t\t\t\tscore: this._config.scores.good,\n\t\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t\t/* Translators: %1$s expands to a link on yoast.com,\n\t\t\t\t\t\t%2$s expands to the anchor end tag. */\n\t\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\t\"%1$sKeyphrase in title%2$s: The exact match of the keyphrase appears at the beginning \" +\n\t\t\t\t\t\t\t\"of the SEO title. Good job!\",\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\t\"</a>\"\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.okay,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to a link on yoast.com,\n\t\t\t\t\t%3$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase in title%3$s: The exact match of the keyphrase appears in the SEO title, but not \" +\n\t\t\t\t\t\t\"at the beginning. %2$sTry to move it to the beginning%3$s.\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( allWordsFound ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.okay,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to a link on yoast.com,\n\t\t\t\t\t%3$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase in title%3$s: Does not contain the exact match. %2$sTry to write the exact match of \" +\n\t\t\t\t\t\t\"your keyphrase in the SEO title%3$s.\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( exactMatchKeyphrase ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.bad,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to a link on yoast.com,\n\t\t\t\t\t%3$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase in title%3$s: Does not contain the exact match. %2$sTry to write the exact match of \" +\n\t\t\t\t\t\t\"your keyphrase in the SEO title%3$s.\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\",\n\t\t\t\t\tkeyword\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tscore: this._config.scores.bad,\n\t\t\tresultText: i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %2$s expand to a link on yoast.com,\n\t\t\t\t%3$s expands to the anchor end tag, %4$s expands to the keyword of the article. */\n\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\"%1$sKeyphrase in title%3$s: Not all the words from your keyphrase \\\"%4$s\\\" appear in the SEO title. \" +\n\t\t\t\t\t\"%2$sTry to use the exact match of your keyphrase in the SEO title%3$s.\"\n\t\t\t\t),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\",\n\t\t\t\tkeyword\n\t\t\t),\n\t\t};\n\t}\n}\n\nexport default TitleKeywordAssessment;\n"]}