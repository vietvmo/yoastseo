{"version":3,"sources":["../../../../src/assessments/seo/OutboundLinksAssessment.js"],"names":["isEmpty","merge","Assessment","createAnchorOpeningTag","AssessmentResult","OutboundLinksAssessment","constructor","config","defaultConfig","scores","noLinksRegular","noLinksRecalibration","allNofollowed","someNoFollowed","allFollowed","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","linkStatistics","getResearch","assessmentResult","setScore","calculateScore","setText","translateScore","isApplicable","hasText","externalTotal","process","env","YOAST_RECALIBRATION","externalNofollow","externalDofollow","sprintf","dgettext"],"mappings":"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","file":"OutboundLinksAssessment.js","sourcesContent":["import { isEmpty, merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment for calculating the outbound links in the text.\n */\nexport default class OutboundLinksAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tscores: {\n\t\t\t\tnoLinksRegular: 6,\n\t\t\t\tnoLinksRecalibration: 3,\n\t\t\t\tallNofollowed: 7,\n\t\t\t\tsomeNoFollowed: 8,\n\t\t\t\tallFollowed: 9,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/34f\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34g\" ),\n\t\t};\n\n\t\tthis.identifier = \"externalLinks\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Runs the getLinkStatistics module, based on this returns an assessment result with score.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed} i18n The object used for translations\n\t *\n\t * @returns {AssessmentResult} The assessment result.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tconst linkStatistics = researcher.getResearch( \"getLinkStatistics\" );\n\t\tconst assessmentResult = new AssessmentResult();\n\t\tif ( ! isEmpty( linkStatistics ) ) {\n\t\t\tassessmentResult.setScore( this.calculateScore( linkStatistics ) );\n\t\t\tassessmentResult.setText( this.translateScore( linkStatistics, i18n ) );\n\t\t}\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Checks whether paper has text.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t *\n\t * @returns {boolean} True when there is text.\n\t */\n\tisApplicable( paper ) {\n\t\treturn paper.hasText();\n\t}\n\n\t/**\n\t * Returns a score based on the linkStatistics object.\n\t *\n\t * @param {object} linkStatistics The object with all link statistics.\n\t *\n\t * @returns {number|null} The calculated score.\n\t */\n\tcalculateScore( linkStatistics ) {\n\t\tif ( linkStatistics.externalTotal === 0 ) {\n\t\t\tif ( process.env.YOAST_RECALIBRATION === \"enabled\" ) {\n\t\t\t\treturn this._config.scores.noLinksRecalibration;\n\t\t\t}\n\n\t\t\treturn this._config.scores.noLinksRegular;\n\t\t}\n\n\t\tif ( linkStatistics.externalNofollow === linkStatistics.externalTotal ) {\n\t\t\treturn this._config.scores.allNofollowed;\n\t\t}\n\n\t\tif ( linkStatistics.externalDofollow < linkStatistics.externalTotal ) {\n\t\t\treturn this._config.scores.someNoFollowed;\n\t\t}\n\n\t\tif ( linkStatistics.externalDofollow === linkStatistics.externalTotal ) {\n\t\t\treturn this._config.scores.allFollowed;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Translates the score to a message the user can understand.\n\t *\n\t * @param {Object} linkStatistics The object with all link statistics.\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {string} The translated string.\n\t */\n\ttranslateScore( linkStatistics, i18n ) {\n\t\tif ( linkStatistics.externalTotal === 0 ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sOutbound links%3$s: \" +\n\t\t\t\t\t\"No outbound links appear in this page. \" +\n\t\t\t\t\t\"%2$sAdd some%3$s!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\"\n\t\t\t);\n\t\t}\n\n\t\tif ( linkStatistics.externalNofollow === linkStatistics.externalTotal ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sOutbound links%3$s: \" +\n\t\t\t\t\t\"All outbound links on this page are nofollowed. \" +\n\t\t\t\t\t\"%2$sAdd some normal links%3$s.\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\"\n\t\t\t);\n\t\t}\n\n\t\tif ( linkStatistics.externalDofollow === linkStatistics.externalTotal ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sOutbound links%2$s: \" +\n\t\t\t\t\t\"Good job!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\"\n\t\t\t);\n\t\t}\n\n\t\tif ( linkStatistics.externalDofollow < linkStatistics.externalTotal ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sOutbound links%2$s: \" +\n\t\t\t\t\t\"There are both nofollowed and normal outbound links on this page. \" +\n\t\t\t\t\t\"Good job!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\",\n\t\t\t);\n\t\t}\n\n\n\t\treturn \"\";\n\t}\n}\n"]}