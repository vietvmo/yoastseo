{"version":3,"sources":["../../../../src/assessments/seo/KeyphraseLengthAssessment.js"],"names":["isUndefined","merge","inRange","Assessment","getFunctionWordsLanguages","getLanguage","createAnchorOpeningTag","AssessmentResult","KeyphraseLengthAssessment","constructor","config","defaultConfig","parameters","recommendedMinimum","recommendedMaximum","acceptableMaximum","parametersNoFunctionWordSupport","scores","veryBad","bad","okay","good","urlTitle","urlCallToAction","isRelatedKeyphrase","identifier","_config","getResult","paper","researcher","i18n","_keyphraseLength","getResearch","assessmentResult","_boundaries","process","env","YOAST_RECALIBRATION","languagesWithFunctionWords","includes","getLocale","calculatedResult","calculateResult","setScore","score","setText","resultText","sprintf","dgettext"],"mappings":"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","file":"KeyphraseLengthAssessment.js","sourcesContent":["import { isUndefined, merge, inRange } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport getFunctionWordsLanguages from \"../../helpers/getFunctionWordsLanguages\";\nimport getLanguage from \"../../helpers/getLanguage\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment to check whether the keyphrase has a good length.\n */\nclass KeyphraseLengthAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t * @param {number} [config.parameters.recommendedMinimum] The recommended minimum length of the keyphrase (in words).\n\t * @param {number} [config.parameters.acceptableMaximum] The acceptable maximum length of the keyphrase (in words).\n\t * @param {number} [config.scores.veryBad] The score to return if the length of the keyphrase is below recommended minimum.\n\t * @param {number} [config.scores.consideration] The score to return if the length of the keyphrase is above acceptable maximum.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tparameters: {\n\t\t\t\trecommendedMinimum: 1,\n\t\t\t\trecommendedMaximum: 4,\n\t\t\t\tacceptableMaximum: 8,\n\t\t\t},\n\t\t\tparametersNoFunctionWordSupport: {\n\t\t\t\trecommendedMaximum: 6,\n\t\t\t\tacceptableMaximum: 9,\n\t\t\t},\n\t\t\tscores: {\n\t\t\t\tveryBad: -999,\n\t\t\t\tbad: 3,\n\t\t\t\tokay: 6,\n\t\t\t\tgood: 9,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/33i\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/33j\" ),\n\t\t\tisRelatedKeyphrase: false,\n\t\t};\n\n\t\tthis.identifier = \"keyphraseLength\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Assesses the keyphrase presence and length.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {AssessmentResult} The result of this assessment.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis._keyphraseLength = researcher.getResearch( \"keyphraseLength\" );\n\t\tconst assessmentResult = new AssessmentResult();\n\t\tthis._boundaries = this._config.parameters;\n\n\t\tif ( process.env.YOAST_RECALIBRATION === \"enabled\" ) {\n\t\t\tconst languagesWithFunctionWords = getFunctionWordsLanguages();\n\n\t\t\t// Make the boundaries less strict if the language of the current paper doesn't have function word support.\n\t\t\tif ( languagesWithFunctionWords.includes( getLanguage( paper.getLocale() ) ) === false ) {\n\t\t\t\tthis._boundaries = merge( {}, this._config.parameters, this._config.parametersNoFunctionWordSupport  );\n\t\t\t}\n\t\t}\n\n\t\tconst calculatedResult = this.calculateResult( i18n );\n\n\t\tif ( ! isUndefined( calculatedResult ) ) {\n\t\t\tassessmentResult.setScore( calculatedResult.score );\n\t\t\tassessmentResult.setText( calculatedResult.resultText );\n\t\t}\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Calculates the result based on the keyphraseLength research.\n\t *\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {Object} Object with score and text.\n\t */\n\tcalculateResult( i18n ) {\n\t\tif ( this._keyphraseLength < this._boundaries.recommendedMinimum ) {\n\t\t\tif ( this._config.isRelatedKeyphrase ) {\n\t\t\t\treturn {\n\t\t\t\t\tscore: this._config.scores.veryBad,\n\t\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\t\"%1$sKeyphrase length%3$s: \" +\n\t\t\t\t\t\t\t\"%2$sSet a keyphrase in order to calculate your SEO score%3$s.\"\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\t\"</a>\"\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.veryBad,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase length%3$s: No focus keyphrase was set for this page. \" +\n\t\t\t\t\t\t\"%2$sSet a keyphrase in order to calculate your SEO score%3$s.\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this._keyphraseLength, this._boundaries.recommendedMinimum, this._boundaries.recommendedMaximum + 1 ) ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.good,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase length%2$s: Good job!\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( inRange( this._keyphraseLength, this._boundaries.recommendedMaximum + 1, this._boundaries.acceptableMaximum + 1 ) ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.okay,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators:\n\t\t\t\t\t%1$d expands to the number of words in the keyphrase,\n\t\t\t\t\t%2$d expands to the recommended maximum of words in the keyphrase,\n\t\t\t\t\t%3$s and %4$s expand to links on yoast.com,\n\t\t\t\t\t%5$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%3$sKeyphrase length%5$s: The keyphrase is %1$d words long. That's more than the recommended maximum of %2$d words. \" +\n\t\t\t\t\t\t\t\"%4$sMake it shorter%5$s!\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._keyphraseLength,\n\t\t\t\t\tthis._boundaries.recommendedMaximum,\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tscore: this._config.scores.bad,\n\t\t\tresultText: i18n.sprintf(\n\t\t\t\t/* Translators:\n\t\t\t\t%1$d expands to the number of words in the keyphrase,\n\t\t\t\t%2$d expands to the recommended maximum of words in the keyphrase,\n\t\t\t\t%3$s and %4$s expand to links on yoast.com,\n\t\t\t\t%5$s expands to the anchor end tag. */\n\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\"%3$sKeyphrase length%5$s: The keyphrase is %1$d words long. That's way more than the recommended maximum of %2$d words. \" +\n\t\t\t\t\t\"%4$sMake it shorter%5$s!\"\n\t\t\t\t),\n\t\t\t\tthis._keyphraseLength,\n\t\t\t\tthis._boundaries.recommendedMaximum,\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\"\n\t\t\t),\n\t\t};\n\t}\n}\n\nexport default KeyphraseLengthAssessment;\n"]}